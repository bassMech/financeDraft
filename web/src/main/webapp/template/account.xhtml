<ui:composition template="/template/layout.xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:p="http://primefaces.org/ui">

	<ui:define name="metadata">
		<title>#{tags['accounts']}</title>
		<f:metadata>
			<f:event type="preRenderView" listener="#{accountView.checkLanguageChange()}" />
		</f:metadata>
	</ui:define>

	<ui:define name="content">
		<h:outputStylesheet name="account.css" library="style" />
		<div class="grid">
			<div class="col-4 col-offset-4 flex justify-content-evenly">
				<div>
					<div>
						<p:tag value="#{tags['month']}" />
					</div>
					<div>
						<p:commandButton icon="pi pi-chevron-left" action="#{accountView.onPreviousMonthClick}" process="@this" update="monthSelect" />
						<p:selectOneMenu id="monthSelect" value="#{accountView.selectedMonth}" style="width:150px">
							<p:ajax listener="#{accountView.onMonthChanged}" />
							<f:selectItems value="#{accountView.selectableMonths.entrySet()}" var="month" itemLabel="#{month.value}" itemValue="#{month.key}" />
						</p:selectOneMenu>
						<p:commandButton icon="pi pi-chevron-right" action="#{accountView.onNextMonthClick}" process="@this" update="monthSelect" />
					</div>
				</div>
				<div>
					<div>
						<p:tag value="#{tags['year']}" />
					</div>
					<div>
						<p:selectOneMenu id="yearSelect" value="#{accountView.selectedYear}" style="width:150px">
							<p:ajax listener="#{accountView.onYearChanged}" />
							<f:selectItems value="#{accountView.selectableYears}" var="year" itemLabel="#{year}" itemValue="#{year}" />
						</p:selectOneMenu>
					</div>
				</div>
			</div>
			<div class="col-4">
				<div class="flex justify-content-end">
					<div>
						<div>
							<p:tag value="#{tags['account']}" />
						</div>
						<div>
							<p:selectOneMenu id="accountSelect" value="#{accountView.selectedAccount}" style="width:150px">
								<p:ajax listener="#{accountView.onAccountChange}" />
								<f:selectItems value="#{accountView.selectableAccounts}" var="account" itemLabel="#{account.title}" itemValue="#{account}" />
							</p:selectOneMenu>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="card flex justify-content-start flex-wrap">
			<p:dataTable id="allocations" var="allocation" value="#{accountView.currentAccountingMonth.allocations}" rowKey="#{allocation.id}"
				rowStyleClass="#{accountView.getAllocationRowColorString(allocation)}" allowUnsorting="true" sortMode="single">

				<p:column headerText="#{tags['title']}" sortBy="#{allocation.title}">
					<h:outputText value="#{allocation.title}" />
				</p:column>>
				<p:column headerText="#{tags['value']}" sortBy="#{allocation.value}">
					<h:outputText value="#{allocation.value}">
						<f:convertNumber currencySymbol = "$" type = "currency" />
					</h:outputText>
				</p:column>>
				<p:column sortBy="#{allocation.expectedDay}" headerText="#{tags['date']}" sortOrder="asc">
					<h:outputText value="#{allocation.expectedDay}" />
				</p:column>
				<p:column headerText="#{tags['executed']}">
					<i class="#{allocation.executedAt == null ? 'pi pi-question-circle': 'pi pi-check-circle'}" />
				</p:column>
			</p:dataTable>

		</div>
	</ui:define>
</ui:composition>


